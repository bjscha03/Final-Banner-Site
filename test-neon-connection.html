<!DOCTYPE html>
<html>
<head>
    <title>Test Neon Database Connection</title>
</head>
<body>
    <h1>üîç Testing Neon Database Connection</h1>
    <div id="output"></div>
    
    <script type="module">
        const output = document.getElementById('output');
        
        function log(message, isError = false) {
            console.log(message);
            const p = document.createElement('p');
            p.style.color = isError ? 'red' : 'black';
            p.style.fontFamily = 'monospace';
            p.innerHTML = typeof message === 'object' ? JSON.stringify(message, null, 2) : message;
            output.appendChild(p);
        }
        
        log('=== TESTING NEON DATABASE CONNECTION ===');
        
        // Test environment variables
        log('Environment check:');
        log('VITE_DATABASE_URL: ' + (import.meta.env.VITE_DATABASE_URL ? 'SET ‚úÖ' : 'NOT SET ‚ùå'));
        
        // Test orders adapter selection
        async function testOrdersAdapter() {
            try {
                log('\n=== TESTING ORDERS ADAPTER ===');
                
                // Import the adapter
                const { getOrdersAdapter } = await import('./src/lib/orders/adapter.ts');
                const adapter = getOrdersAdapter();
                
                log('Adapter obtained: ' + (adapter ? 'SUCCESS ‚úÖ' : 'FAILED ‚ùå'));
                log('Adapter type: ' + typeof adapter);
                
                if (adapter && adapter.listByUser) {
                    log('Testing listByUser method...');
                    
                    // Test with a sample user ID
                    const testUserId = 'dev_user_123';
                    const orders = await adapter.listByUser(testUserId);
                    
                    log('Orders retrieved: ' + orders.length + ' orders');
                    if (orders.length > 0) {
                        log('Sample order:', orders[0]);
                    } else {
                        log('No orders found for user: ' + testUserId);
                    }
                }
                
            } catch (error) {
                log('Error testing orders adapter: ' + error.message, true);
                log('Error details:', error, true);
            }
        }
        
        // Test user creation
        async function testUserCreation() {
            try {
                log('\n=== TESTING USER AUTHENTICATION ===');
                
                const { useAuth } = await import('./src/lib/auth.ts');
                log('Auth module loaded successfully ‚úÖ');
                
                // Test sign in
                const testEmail = 'test@example.com';
                const testPassword = 'password123';
                
                log('Testing sign in with: ' + testEmail);
                // Note: This would need to be tested in the actual React app context
                
            } catch (error) {
                log('Error testing auth: ' + error.message, true);
            }
        }
        
        // Run tests
        testOrdersAdapter();
        testUserCreation();
    </script>
</body>
</html>
